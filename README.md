# nyc-subway
2024 Spring ENGR 1050 Final Project

# How to Run: 
*Option 1*

Download the .zip file “ENGR 1050 Final Project” and upload it to Google Drive. On Colab, run the first and second blocks of code. This will unzip this zip file. Change endLoc in the second block of code as desired.

You will need to change realTimeData (block 3 line 8), stops (block 3 line 9), and bullet (line 143) in the main code file depending on your file directory arrangement. 

Note that this program takes around 10-13 minutes to complete. Google Colab has a tendency to disconnect the runtime at random, so if this occurs while running the program, you may need to rerun it.

# Summary
For this project, we analyzed data provided by the MTA for the New York City Subway. The MTA provides real time data, as to the positions of trains in the system, and various sources collect this data. We were able to gain access to the data collected for all the trains in the system on Monday, February 19th, 2024 (which we can treat as a “typical” weekday). With this data, we set out to explore three main ideas. Firstly, we wanted to visually understand the paths of trains as they traveled through the system during morning and evening rush hours; this could lead to qualitative insights as to where trains tend to terminate, whether trains run express vs. local on a certain line, or where choke points tend to occur that could lead to cascading delays. Secondly, we sought to explore the distribution of interval times for each line (we define an interval time to be the time between trains of a certain line at a certain station—to take the distribution of these interval times for a specific line, we combine all the interval times for all the stations on that line). We wanted to explore how different lines have similar or different interval time distributions using statistical testing. Finally, using the median of interval time distributions as a loose quantitative measure of line performance, we wanted to rank train lines based on the median of their interval time distributions. We also wanted to come up with the average wait time for each line (which is found by averaging the interval time distribution if it is assumed that subway lines behave as a Poisson distribution).

For the first part of my program, we imported two CSV files as pandas dataframes. One contained the stop times for each trip a train took. This dataframe displayed the train ID, when that train stopped at a given station, when it left that station, and so on for all the stations in that trip. It collected this data for all train trips of all the NYC Subway lines on this arbitrarily chosen date. The other CSV file contained the stop ID for all stations in the NYC subway system and data relating to that stop ID, including the street name of that stop. We set the directories referring to these files as global variables. For each trunk line (color in the subway system), we then ran trainPlot to gain a plot of the paths of trains as they traveled north and south through the system during morning and evening rush hours. After this, we created histograms displaying the train interval distribution for all the number lines (known as the IRT) and all of the letter lines (known as the IND or BMT) separately. We ran statistical tests on the distributions at a given rush hour time and with a given direction (north or south) for each line and obtained a dictionary of Shapiro-Wilk test p-values, an ANOVA test p-value, a boolean indicating whether the set of data we provided was all normal or not, and a dataframe containing the pairwise two sample t-test or Mann-Whitney U test p-val (depending on whether all the data are normally distributed or not). We inputted this dataframe into the makeHeatmap function in order to create a logarithmically-scaled heatmap of pairwise p-values. Finally, we printed the mean wait times for each line as a dictionary and ran boxAndWhisker to generate a box and whisker plot for each line ordered from smallest median interval time to largest median interval time.
	
We fulfilled computation through extensive filtering and manipulations of the imported CSV file (which involved filtering by time of day, querying by line, the conversion of HH:MM:SS time into time in just seconds), scaling of my plots to ensure that they all had the same size regardless of the number of plots on each figure, creating a distribution that collected the seconds between trains at a station during a specified time of day, logarithmic scaling of the heatmap of pairwise p-values (to make it easier to read), and the calculation of the mean and five number summary for each line’s time interval distribution. 

For statistics, we performed various analyses, including a Shapiro-Wilk Test to determine normality, an ANOVA Test, and pairwise Mann-Whitney U Test/Two Sample t Test depending on the normality of the distributions. We also collected a five number summary for each line’s time interval distribution and calculated a mean.

For data visualization, we created a line plot for each line, time of day, and direction to show the path train lines took as they traveled from their origin to their terminus. In this plot, we added the image of each train bullet to the title as well as the stop names on the y-axis instead of the internal values we assigned to them. We also created various histograms displaying time interval distributions as well as a boxplot ranking train lines from least to greatest median time interval distribution and giving a better comparison of time interval distributions between lines. In this latter visualization, we was able to color each boxplot by the color corresponding to the train line.
